geom_label(aes(label = value),
position = position_stack(vjust = 0.3),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = value),
position = position_stack(vjust = 1),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = value),
position = position_stack(vjust = 05),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = value),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018$percent <- as.double(tidy_big_2018/total)
tidy_big_2018$percent <- as.double(tidy_big_2018$value/total)
tidy_big_2018$percent <- round(as.double(tidy_big_2018$value/total), 2)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
guides(fill=guide_legend(title="New Legend Title"))
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0)
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0) +
guides(fill = guide_legend(title = "Title"))
tidy_big_2018 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE) +
scale_fill_brewer(palette="Blues")+
coord_polar(theta = "y", start = 0) +
guides(fill = guide_legend(title = "Country"))
#-------------------------------------------------------------------------------
tidy_big <- big %>%
gather("year", "value", 5:55)
tidy_big$year <- as.Date(tidy_big$year, 'X%Y..YR%Y.')
tidy_big$year <- format(tidy_big$year, format = "%Y")
tidy_big = mutate(tidy_big, year=as.integer(year))
tidy_big_2018_school <- tidy_big %>%
filter(tidy_big$year == 2018)
tidy_big_2018_school = mutate(tidy_big_2018_school, value=as.integer(value))
tidy_big_2018_school <- na.omit(tidy_big_2018_school)
tidy_big_2018_school <- tidy_big_2018_school %>%
filter(tidy_big_2018_school$Series.Code == "SE.PRM.AGES")
View(tidy_big_2018_school)
tidy_big_2018 <- tidy_big_2018 %>%
filter(tidy_big_2018$Country.Code != "HIC" & tidy_big_2018$Country.Code != "LIC")
tidy_big_2018_school %>%
ggplot(aes(value)) +
geom_bar(width = 1)
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
#-------------------------------------------------------------------------------
names(bh_diff)[2] <- "Difficulty" #How difficult is to find a new block
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
scale_fill_brewer(palette="Blues")
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, col = pp_blue) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
ggplot(aes(value)) + geom_bar(width = 1, aes(col = pp_blue) +
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, aes(col = pp_blue)) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, aes(fill = pp_blue)) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, fill = pp_blue) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, fill = pp_blue) +
ggtitle("Primary school starting age accross the countries", subtitle = "In 2018") +
xlab("Age") + ylab("") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_school %>%
ggplot(aes(value)) + geom_bar(width = 1, fill = pp_blue) +
ggtitle("Primary school starting age world distribution", subtitle = "In 2018") +
xlab("Age") + ylab("") +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
View(tidy_big)
tidy_big_2018_urban <- tidy_big %>%
filter(tidy_big$year == 2018)
tidy_big_2018_urban = mutate(tidy_big_2018_urban, value=as.integer(value))
tidy_big_2018_urban <- na.omit(tidy_big_2018_urban)
tidy_big_2018_urban <- tidy_big_2018_urban %>%
filter(tidy_big_2018_urban$Series.Code == "SP.POP.TOTL" | tidy_big_2018_urban$Series.Code == "SP.RUR.TOTL" | tidy_big_2018_urban$Series.Code == "
SP.URB.TOTL")
View(tidy_big_2018_urban)
tidy_big_2018_urban <- tidy_big %>%
filter(tidy_big$year == 2018)
tidy_big_2018_urban = mutate(tidy_big_2018_urban, value=as.integer(value))
tidy_big_2018_urban <- na.omit(tidy_big_2018_urban)
tidy_big_2018_urban <- tidy_big_2018_urban %>%
filter(tidy_big_2018_urban$Series.Code == "SP.POP.TOTL" | tidy_big_2018_urban$Series.Code == "SP.RUR.TOTL" | tidy_big_2018_urban$Series.Code == "SP.URB.TOTL")
tidy_big_2018_teachers <- tidy_big_2018 %>%
filter(tidy_big_2018$Series.Code == "SE.SEC.TCHR")
tidy_big_2018_pupils <- tidy_big_2018 %>%
filter(tidy_big_2018$Series.Code == "SE.SEC.ENRL")
tidy_big_2018_edu <- merge(tidy_big_2018_teachers, tidy_big_2018_pupils, by=c("Country.Name","Country.Code", "Series.Name", "Series.Code", "year"))
tidy_big_1995 <- tidy_big %>%
filter(tidy_big$year == 1995)
tidy_big_1995 = mutate(tidy_big_1995, value=as.integer(value))
tidy_big_1995 <- na.omit(tidy_big_1995)
tidy_big_1995_teachers <- tidy_big_1995 %>%
filter(tidy_big_1995$Series.Code == "SE.SEC.TCHR")
tidy_big_1995_pupils <- tidy_big_1995 %>%
filter(tidy_big_1995$Series.Code == "SE.SEC.ENRL")
tidy_big_1955_edu <- merge(tidy_big_1995_teachers, tidy_big_1995_pupils, by=c("Country.Name","Country.Code", "Series.Name", "Series.Code", "year"))
tidy_big_2018 <- tidy_big %>%
filter(tidy_big$year == 2018)
tidy_big_2018 = mutate(tidy_big_2018, value=as.integer(value))
tidy_big_2018 <- na.omit(tidy_big_2018)
tidy_big_2018 <- tidy_big_2018 %>%
filter(tidy_big_2018$Series.Code == "SP.POP.TOTL")
tidy_big_2018 <- tidy_big_2018 %>%
arrange(-value)
tidy_big_2018 <- tidy_big_2018 %>%
filter(tidy_big_2018$Country.Code != "HIC" & tidy_big_2018$Country.Code != "LIC")
tidy_big_2018_20 <- tidy_big_2018 %>%
top_n(20)
tidy_big_2018_20 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity") +
theme_minimal() +
ggtitle("Population of the world in 2018", subtitle = {paste0('Total: ', total)})+
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue)) +
theme(axis.line = element_blank(),
plot.title = element_text(hjust=0.5),
axis.text.x = element_blank(),
axis.text.y = element_blank()) +
labs(fill = "Country.Name",
x=NULL,
y=NULL) +
geom_label(aes(label = percent),
position = position_stack(vjust = 0.5),
show.legend = FALSE)
View(tidy_big_2018)
View(tidy_big_2018_20)
tidy_big_2018_20 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(width = 1, stat = "identity")
tidy_big_2018_20 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar(stat = "identity")
tidy_big_2018_20 %>%
ggplot(aes(x = "", y = value, fill = Country.Name)) +
geom_bar()
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value, fill = Country.Name)) +
geom_bar()
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) +
geom_bar()
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity")
tidy_big_2018_20 <- tidy_big_2018 %>%
top_n(10)
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity")
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") +
xlab("") + ylab("")
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 500000000), labels = function(x){paste0(x/1000000, 'M')})
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 200000000), labels = function(x){paste0(x/1000000, 'M')})
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')})
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal()
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity") +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity", fill = pp_blue) +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue))
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity", fill = pp_blue) +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue),
axis.text.x = element_text(angle=65, vjust=0.6))
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity", fill = pp_blue) +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue),
axis.text.x = element_text(angle=30, vjust=0.6))
tidy_big_2018_20 %>%
ggplot(aes(x = Country.Name, y = value)) + geom_bar(stat = "identity", fill = pp_blue) +
ggtitle("Countries by the population", subtitle = "In 2018") + xlab("") + ylab("") +
scale_y_continuous(breaks=seq(0, 1392730000, 250000000), labels = function(x){paste0(x/1000000, 'M')}) +
theme_minimal() +
theme(plot.title = element_text(size = 30,
family = "Montserrat",
color = pp_blue,
face = "bold"),
plot.subtitle = element_text(size = 15,
family = "Calibri",
color = pp_blue),
axis.text.x = element_text(angle=45, vjust=0.6))
setwd("D:/Polibuda/Semestr 4/Data Visualisation/03/Hw/Data pack")
setwd("D:/Polibuda/Semestr 4/Data Visualisation/03/Hw")
#gold <- read.csv("Gold prices.csv")
exchange <- read.csv(url)
tidy_gold <- gold %>%
gather("currency", "value", 2:7)
